<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Little_logger__Logger (little_logger.Little_logger__Logger)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">little_logger</a> &#x00BB; Little_logger__Logger</nav><h1>Module <code>Little_logger__Logger</code></h1><p>A tiny, little logger &lt;3</p><h2 id="overview"><a href="#overview" class="anchor"></a>Overview</h2><h3 id="set-up"><a href="#set-up" class="anchor"></a>Set up</h3><p>The default log level is <code>Level.Warning</code> and the default printer is <code>prerr_endline</code>.</p><p>To change these, use the <a href="index.html#val-set_log_level"><code>set_log_level</code></a> and <a href="index.html#val-set_printer"><code>set_printer</code></a> functions.</p><h3 id="messages"><a href="#messages" class="anchor"></a>Messages</h3><p>Logging functions come in two flavors: those that accept a <code>message</code> (e.g., <code>info</code>, <code>error</code>), and those that accept strings directly (e.g., <code>sinfo</code>, <code>serror</code>).</p><p>A <code>message</code> is simply a <code>unit -&gt; string</code> <a href="https://en.wikipedia.org/wiki/Thunk">thunk</a>. Because <code>message</code> is a thunk, its evaluation won't happen unless the message actually needs to be printed. The type <code>message</code> is just a name given to the thunk to clarify the function signatures.</p><p>The functions that take a string directly are prefixed with an <code>s</code> (for string).</p><h3 id="printers"><a href="#printers" class="anchor"></a>Printers</h3><p>A <code>printer</code> is a function with the following signature <code>string -&gt; unit</code>. The name <code>printer</code> is simply used for clarity.</p><p>Common choices for a <code>printer</code> would be <code>prerr_endline</code> to print to <code>stderr</code>, or <code>Async.prerr_endline</code> to asynchronously print to <code>stderr</code> using <code>Async.Writer</code> (e.g., if you are using Jane Street's <code>Async</code> library.</p><h3 id="message-levels"><a href="#message-levels" class="anchor"></a>Message Levels</h3><p>Message levels are hierarchical: given the log level threshold (<a href="index.html#val-get_log_level"><code>get_log_level</code></a>), all messages of equal or higher priority will be logged.</p><p>In other words, if a message level is greater than or equal to the logging threshold, it will be printed.</p><p>For example, <code>Level.Trace</code> would print all messages, <code>Level.Silent</code> would print no messages, <code>Level.Error</code> would print <code>Level.Error</code>, <code>Level.Fatal</code>, and <code>Level.Unknown</code> messages.</p><p>The default log level is <code>Level.Warning</code>. All messages of equal or higher priority than this will be logged.</p><h2 id="examples"><a href="#examples" class="anchor"></a>Examples</h2><p>Note: the examples assume you have <code>open Little_logger</code> at the top of your file.</p><h3 id="logging-messages"><a href="#logging-messages" class="anchor"></a>Logging messages</h3><pre><code class="ml">let () = Logger.error (fun () -&gt; &quot;This is an error&quot;)
let () = Logger.serror &quot;This is an error, but using `serror` instead&quot;

let () =
  Logger.info (fun () -&gt;
      sprintf &quot;I can use %s strings like %s&quot; &quot;format&quot; &quot;this&quot;)</code></pre><p>Using the thunk accepting functions let you avoid potentially expensive calls in cases where the log level would prevent a message from being printed.</p><pre><code class="ml">let () = Logger.set_log_level Logger.Level.Error

(* This won't run and the expensive thing won't take up extra time. *) let
() = Logger.debug (fun () -&gt; (* ...Call some expensive log message
generating function here... *) )</code></pre><h3 id="changing-the-logging-level"><a href="#changing-the-logging-level" class="anchor"></a>Changing the logging level</h3><p>The default level is <code>Warning</code>. Here we lower it to <code>Debug</code>.</p><pre><code class="ml">let () = Logger.set_log_level Logger.Level.Debug </code></pre><h3 id="changing-the-printer"><a href="#changing-the-printer" class="anchor"></a>Changing the printer</h3><p>The default printer is <code>prerr_endline</code>, which prints to <code>stderr</code>. We can change to printing to <code>stdout</code> like this.</p><pre><code class="ml">let () = Logger.set_printer print_endline </code></pre><p>If you're using the <code>Async</code> library, just change to an async printer.</p><pre><code class="ml">let () = Logger.set_printer Async.prerr_endline </code></pre><h4 id="writing-directly-to-a-file"><a href="#writing-directly-to-a-file" class="anchor"></a>Writing directly to a file</h4><p>If you want to get crazy you could do something like this to log directly to a file, but I don't know if it is the best idea :)</p><pre><code class="ml">let log_fname = &quot;silly_file.txt&quot;
let log_chan = Out_channel.create &quot;silly_file.txt&quot;

let printer msg = Out_channel.output_string log_chan (msg ^ &quot;\n&quot;)
let () = Logger.set_printer printer

let () = Logger.info (fun () -&gt; &quot;Hi file!&quot;)

let () = Out_channel.close log_chan</code></pre><nav class="toc"><ul><li><a href="#api">API</a><ul><li><a href="#level">Level</a></li><li><a href="#type-aliases">Type aliases</a></li><li><a href="#getters-and-setters">Getters and setters</a></li><li><a href="#message_accepting">Message accepting log functions</a></li><li><a href="#string-accepting-log-functions">String accepting log functions</a></li></ul></li></ul></nav></header><section><header><h2 id="api"><a href="#api" class="anchor"></a>API</h2></header><section><header><h3 id="level"><a href="#level" class="anchor"></a>Level</h3></header><div class="spec module" id="module-Level"><a href="#module-Level" class="anchor"></a><code><span class="keyword">module</span> <a href="Level/index.html">Level</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></section><section><header><h3 id="type-aliases"><a href="#type-aliases" class="anchor"></a>Type aliases</h3></header><dl><dt class="spec type" id="type-printer"><a href="#type-printer" class="anchor"></a><code><span class="keyword">type</span> printer</code><code> = string <span>&#45;&gt;</span> unit</code></dt><dd><p>Type alias for printer functions</p></dd></dl><dl><dt class="spec type" id="type-message"><a href="#type-message" class="anchor"></a><code><span class="keyword">type</span> message</code><code> = unit <span>&#45;&gt;</span> string</code></dt><dd><p>Type alias for message thunks</p></dd></dl></section><section><header><h3 id="getters-and-setters"><a href="#getters-and-setters" class="anchor"></a>Getters and setters</h3></header><dl><dt class="spec value" id="val-get_log_level"><a href="#val-get_log_level" class="anchor"></a><code><span class="keyword">val</span> get_log_level : unit <span>&#45;&gt;</span> <a href="Level/index.html#type-t">Level.t</a></code></dt><dt class="spec value" id="val-set_log_level"><a href="#val-set_log_level" class="anchor"></a><code><span class="keyword">val</span> set_log_level : <a href="Level/index.html#type-t">Level.t</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-set_printer"><a href="#val-set_printer" class="anchor"></a><code><span class="keyword">val</span> set_printer : <a href="index.html#type-printer">printer</a> <span>&#45;&gt;</span> unit</code></dt></dl></section><section><header><h3 id="message_accepting"><a href="#message_accepting" class="anchor"></a>Message accepting log functions</h3></header><dl><dt class="spec value" id="val-unknown"><a href="#val-unknown" class="anchor"></a><code><span class="keyword">val</span> unknown : <a href="index.html#type-message">message</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>unknown msg</code> logs an unknown message. Unknown messages are printed when log level is <code>Level.Unknown</code> or below.</p></dd></dl><dl><dt class="spec value" id="val-fatal"><a href="#val-fatal" class="anchor"></a><code><span class="keyword">val</span> fatal : <a href="index.html#type-message">message</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>fatal msg</code> logs an fatal message. Fatal messages are printed when log level is <code>Level.Fatal</code> or below.</p></dd></dl><dl><dt class="spec value" id="val-error"><a href="#val-error" class="anchor"></a><code><span class="keyword">val</span> error : <a href="index.html#type-message">message</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>error msg</code> logs an error message. Error messages are printed when log level is <code>Level.Error</code> or below.</p></dd></dl><dl><dt class="spec value" id="val-warning"><a href="#val-warning" class="anchor"></a><code><span class="keyword">val</span> warning : <a href="index.html#type-message">message</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>warning msg</code> logs an warning message. Warning messages are printed when log level is <code>Level.Warning</code> or below.</p></dd></dl><dl><dt class="spec value" id="val-info"><a href="#val-info" class="anchor"></a><code><span class="keyword">val</span> info : <a href="index.html#type-message">message</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>info msg</code> logs an info message. Info messages are printed when log level is <code>Level.Info</code> or below.</p></dd></dl><dl><dt class="spec value" id="val-debug"><a href="#val-debug" class="anchor"></a><code><span class="keyword">val</span> debug : <a href="index.html#type-message">message</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>debug msg</code> logs an debug message. Debug messages are printed when log level is <code>Level.Debug</code> or below.</p></dd></dl><dl><dt class="spec value" id="val-trace"><a href="#val-trace" class="anchor"></a><code><span class="keyword">val</span> trace : <a href="index.html#type-message">message</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>trace msg</code> logs an trace message. Trace messages are printed when log level is <code>Level.Trace</code> or below.</p></dd></dl></section><section><header><h3 id="string-accepting-log-functions"><a href="#string-accepting-log-functions" class="anchor"></a>String accepting log functions</h3><p>These are analogous to the <a href="index.html#message_accepting"><span>message accepting</span></a> log functions.</p></header><dl><dt class="spec value" id="val-sunknown"><a href="#val-sunknown" class="anchor"></a><code><span class="keyword">val</span> sunknown : string <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-sfatal"><a href="#val-sfatal" class="anchor"></a><code><span class="keyword">val</span> sfatal : string <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-serror"><a href="#val-serror" class="anchor"></a><code><span class="keyword">val</span> serror : string <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-swarning"><a href="#val-swarning" class="anchor"></a><code><span class="keyword">val</span> swarning : string <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-sinfo"><a href="#val-sinfo" class="anchor"></a><code><span class="keyword">val</span> sinfo : string <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-sdebug"><a href="#val-sdebug" class="anchor"></a><code><span class="keyword">val</span> sdebug : string <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-strace"><a href="#val-strace" class="anchor"></a><code><span class="keyword">val</span> strace : string <span>&#45;&gt;</span> unit</code></dt></dl></section></section></div></body></html>