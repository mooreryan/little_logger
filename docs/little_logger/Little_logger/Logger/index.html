<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Logger (little_logger.Little_logger.Logger)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">little_logger</a> &#x00BB; <a href="../index.html">Little_logger</a> &#x00BB; Logger</nav><header class="odoc-preamble"><h1>Module <code><span>Little_logger.Logger</span></code></h1><p>A tiny, little logger &lt;3</p></header><nav class="odoc-toc"><ul><li><a href="#overview">Overview</a><ul><li><a href="#set-up">Set up</a></li><li><a href="#messages">Messages</a></li><li><a href="#printers">Printers</a></li><li><a href="#message-levels">Message Levels</a></li></ul></li><li><a href="#examples">Examples</a><ul><li><a href="#logging-messages">Logging messages</a></li><li><a href="#changing-the-logging-level">Changing the logging level</a></li><li><a href="#changing-the-printer">Changing the printer</a><ul><li><a href="#writing-directly-to-a-file">Writing directly to a file</a></li></ul></li></ul></li><li><a href="#api">API</a><ul><li><a href="#level">Level</a></li><li><a href="#type-aliases">Type aliases</a></li><li><a href="#getters-and-setters">Getters and setters</a></li><li><a href="#message_accepting">Message accepting log functions</a></li><li><a href="#string-accepting-log-functions">String accepting log functions</a></li></ul></li></ul></nav><div class="odoc-content"><h2 id="overview"><a href="#overview" class="anchor"></a>Overview</h2><h3 id="set-up"><a href="#set-up" class="anchor"></a>Set up</h3><p>The default log level is <code>Level.Warning</code> and the default printer is <code>prerr_endline</code>.</p><p>To change these, use the <a href="#val-set_log_level"><code>set_log_level</code></a> and <a href="#val-set_printer"><code>set_printer</code></a> functions.</p><h3 id="messages"><a href="#messages" class="anchor"></a>Messages</h3><p>Logging functions come in two flavors: those that accept a <code>message</code> (e.g., <code>info</code>, <code>error</code>), and those that accept strings directly (e.g., <code>sinfo</code>, <code>serror</code>).</p><p>A <code>message</code> is simply a <code>unit -&gt; string</code> <a href="https://en.wikipedia.org/wiki/Thunk">thunk</a>. Because <code>message</code> is a thunk, its evaluation won't happen unless the message actually needs to be printed. The type <code>message</code> is just a name given to the thunk to clarify the function signatures.</p><p>The functions that take a string directly are prefixed with an <code>s</code> (for string).</p><h3 id="printers"><a href="#printers" class="anchor"></a>Printers</h3><p>A <code>printer</code> is a function with the following signature <code>string -&gt; unit</code>. The name <code>printer</code> is simply used for clarity.</p><p>Common choices for a <code>printer</code> would be <code>prerr_endline</code> to print to <code>stderr</code>, or <code>Async.prerr_endline</code> to asynchronously print to <code>stderr</code> using <code>Async.Writer</code> (e.g., if you are using Jane Street's <code>Async</code> library.</p><h3 id="message-levels"><a href="#message-levels" class="anchor"></a>Message Levels</h3><p>Message levels are hierarchical: given the log level threshold (<a href="#val-get_log_level"><code>get_log_level</code></a>), all messages of equal or higher priority will be logged.</p><p>In other words, if a message level is greater than or equal to the logging threshold, it will be printed.</p><p>For example, <code>Level.Trace</code> would print all messages, <code>Level.Silent</code> would print no messages, <code>Level.Error</code> would print <code>Level.Error</code>, <code>Level.Fatal</code>, and <code>Level.Unknown</code> messages.</p><p>The default log level is <code>Level.Warning</code>. All messages of equal or higher priority than this will be logged.</p><h2 id="examples"><a href="#examples" class="anchor"></a>Examples</h2><p>Note: the examples assume you have <code>open Little_logger</code> at the top of your file.</p><h3 id="logging-messages"><a href="#logging-messages" class="anchor"></a>Logging messages</h3><pre><code>let () = Logger.error (fun () -&gt; &quot;This is an error&quot;)
let () = Logger.serror &quot;This is an error, but using `serror` instead&quot;

let () =
  Logger.info (fun () -&gt;
      sprintf &quot;I can use %s strings like %s&quot; &quot;format&quot; &quot;this&quot;)</code></pre><p>Using the thunk accepting functions let you avoid potentially expensive calls in cases where the log level would prevent a message from being printed.</p><pre><code>let () = Logger.set_log_level Logger.Level.Error

(* This won't run and the expensive thing won't take up extra time. *) let
() = Logger.debug (fun () -&gt; (* ...Call some expensive log message
generating function here... *) )</code></pre><h3 id="changing-the-logging-level"><a href="#changing-the-logging-level" class="anchor"></a>Changing the logging level</h3><p>The default level is <code>Warning</code>. Here we lower it to <code>Debug</code>.</p><pre><code>let () = Logger.set_log_level Logger.Level.Debug </code></pre><h3 id="changing-the-printer"><a href="#changing-the-printer" class="anchor"></a>Changing the printer</h3><p>The default printer is <code>prerr_endline</code>, which prints to <code>stderr</code>. We can change to printing to <code>stdout</code> like this.</p><pre><code>let () = Logger.set_printer print_endline </code></pre><p>If you're using the <code>Async</code> library, just change to an async printer.</p><pre><code>let () = Logger.set_printer Async.prerr_endline </code></pre><h4 id="writing-directly-to-a-file"><a href="#writing-directly-to-a-file" class="anchor"></a>Writing directly to a file</h4><p>If you want to get crazy you could do something like this to log directly to a file, but I don't know if it is the best idea :)</p><pre><code>let log_fname = &quot;silly_file.txt&quot;
let log_chan = Out_channel.create &quot;silly_file.txt&quot;

let printer msg = Out_channel.output_string log_chan (msg ^ &quot;\n&quot;)
let () = Logger.set_printer printer

let () = Logger.info (fun () -&gt; &quot;Hi file!&quot;)

let () = Out_channel.close log_chan</code></pre><h2 id="api"><a href="#api" class="anchor"></a>API</h2><h3 id="level"><a href="#level" class="anchor"></a>Level</h3><div class="odoc-spec"><div class="spec module" id="module-Level" class="anchored"><a href="#module-Level" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Level/index.html">Level</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Logging levels</p></div></div><h3 id="type-aliases"><a href="#type-aliases" class="anchor"></a>Type aliases</h3><div class="odoc-spec"><div class="spec type" id="type-printer" class="anchored"><a href="#type-printer" class="anchor"></a><code><span><span class="keyword">type</span> printer</span><span> = <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Type alias for printer functions</p></div></div><div class="odoc-spec"><div class="spec type" id="type-message" class="anchored"><a href="#type-message" class="anchor"></a><code><span><span class="keyword">type</span> message</span><span> = <span>unit <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Type alias for message thunks</p></div></div><h3 id="getters-and-setters"><a href="#getters-and-setters" class="anchor"></a>Getters and setters</h3><div class="odoc-spec"><div class="spec value" id="val-get_log_level" class="anchored"><a href="#val-get_log_level" class="anchor"></a><code><span><span class="keyword">val</span> get_log_level : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="Level/index.html#type-t">Level.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-set_log_level" class="anchored"><a href="#val-set_log_level" class="anchor"></a><code><span><span class="keyword">val</span> set_log_level : <span><a href="Level/index.html#type-t">Level.t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-set_printer" class="anchored"><a href="#val-set_printer" class="anchor"></a><code><span><span class="keyword">val</span> set_printer : <span><a href="#type-printer">printer</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><h3 id="message_accepting"><a href="#message_accepting" class="anchor"></a>Message accepting log functions</h3><div class="odoc-spec"><div class="spec value" id="val-unknown" class="anchored"><a href="#val-unknown" class="anchor"></a><code><span><span class="keyword">val</span> unknown : <span><a href="#type-message">message</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>unknown msg</code> logs an unknown message. Unknown messages are printed when log level is <code>Level.Unknown</code> or below.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fatal" class="anchored"><a href="#val-fatal" class="anchor"></a><code><span><span class="keyword">val</span> fatal : <span><a href="#type-message">message</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>fatal msg</code> logs an fatal message. Fatal messages are printed when log level is <code>Level.Fatal</code> or below.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-error" class="anchored"><a href="#val-error" class="anchor"></a><code><span><span class="keyword">val</span> error : <span><a href="#type-message">message</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>error msg</code> logs an error message. Error messages are printed when log level is <code>Level.Error</code> or below.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-warning" class="anchored"><a href="#val-warning" class="anchor"></a><code><span><span class="keyword">val</span> warning : <span><a href="#type-message">message</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>warning msg</code> logs an warning message. Warning messages are printed when log level is <code>Level.Warning</code> or below.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-info" class="anchored"><a href="#val-info" class="anchor"></a><code><span><span class="keyword">val</span> info : <span><a href="#type-message">message</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>info msg</code> logs an info message. Info messages are printed when log level is <code>Level.Info</code> or below.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-debug" class="anchored"><a href="#val-debug" class="anchor"></a><code><span><span class="keyword">val</span> debug : <span><a href="#type-message">message</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>debug msg</code> logs an debug message. Debug messages are printed when log level is <code>Level.Debug</code> or below.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-trace" class="anchored"><a href="#val-trace" class="anchor"></a><code><span><span class="keyword">val</span> trace : <span><a href="#type-message">message</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>trace msg</code> logs an trace message. Trace messages are printed when log level is <code>Level.Trace</code> or below.</p></div></div><h3 id="string-accepting-log-functions"><a href="#string-accepting-log-functions" class="anchor"></a>String accepting log functions</h3><p>These are analogous to the <a href="#message_accepting">message accepting</a> log functions.</p><div class="odoc-spec"><div class="spec value" id="val-sunknown" class="anchored"><a href="#val-sunknown" class="anchor"></a><code><span><span class="keyword">val</span> sunknown : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-sfatal" class="anchored"><a href="#val-sfatal" class="anchor"></a><code><span><span class="keyword">val</span> sfatal : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-serror" class="anchored"><a href="#val-serror" class="anchor"></a><code><span><span class="keyword">val</span> serror : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-swarning" class="anchored"><a href="#val-swarning" class="anchor"></a><code><span><span class="keyword">val</span> swarning : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-sinfo" class="anchored"><a href="#val-sinfo" class="anchor"></a><code><span><span class="keyword">val</span> sinfo : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-sdebug" class="anchored"><a href="#val-sdebug" class="anchor"></a><code><span><span class="keyword">val</span> sdebug : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-strace" class="anchored"><a href="#val-strace" class="anchor"></a><code><span><span class="keyword">val</span> strace : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div></div></body></html>